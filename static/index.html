<html>

<head>
</head>

<body>
  <canvas id="renderCanvas"></canvas>
  <div>
    <h4>Usage:</h4>
    <ul>
      <li>Select and click to add a cube</li>
      <li>Press d to delete</li>
    </ul>
  </div>
  <textarea id="log" style="width: 50%; height: 100px;"></textarea>

  <script id="vs" type="x-shader/x-vertex">
    varying vec3 vNormal;

    void main() { 
        gl_Position = projectionMatrix * modelViewMatrix * vec4(position,1.0);
        vNormal = normal;
    }
  </script>
  <script id="fs" type="x-shader/x-fragment">
    varying vec3 vNormal;
    uniform ivec3 uIndex;

    void main() {
      int fac = 0;
      if (vNormal.x < -.1 && abs(vNormal.y) < .1 && abs(vNormal.z) < .1) {
        fac = 1;
      } else if (vNormal.x > .1 && abs(vNormal.y) < .1 && abs(vNormal.z) < .1) {
        fac = 2;
      } else if (abs(vNormal.x) < .1 && vNormal.y < -.1 && abs(vNormal.z) < .1) {
        fac = 3;
      } else if (abs(vNormal.x) < .1 && vNormal.y > .1 && abs(vNormal.z) < .1) {
        fac = 4;
      } else if (abs(vNormal.x) < .1 && abs(vNormal.y) < .1 && vNormal.z < -.1) {
        fac = 5;
      } else if (abs(vNormal.x) < .1 && abs(vNormal.y) < .1 && vNormal.z > .1) {
        fac = 6;
      }

      gl_FragColor = vec4(
        abs(vNormal.x) / 2.0 + 0.25 - float(uIndex.x) / 10.0,
        abs(vNormal.y) / 2.0 + 0.25 - float(uIndex.y) / 10.0,
        abs(vNormal.z) / 2.0 + 0.25 - float(uIndex.z) / 10.0,
        1.0 - float(fac) / 10.0
      );
    }
  </script>

  <script id="vsPick" type="x-shader/x-vertex">
    varying vec3 vNormal;

    void main() { 
        gl_Position = projectionMatrix * modelViewMatrix * vec4(position,1.0);
        vNormal = normal;
    }
  </script>
  <script id="fsPick" type="x-shader/x-fragment">
    varying vec3 vNormal;
    uniform int uIndex;

    void main() {
      if (vNormal.x < -.1 && abs(vNormal.y) < .1 && abs(vNormal.z) < .1 && uIndex == 1) {
        gl_FragColor = vec4(1.0, 0, 0, 1.0);
        return;
      } else if (vNormal.x > .1 && abs(vNormal.y) < .1 && abs(vNormal.z) < .1 && uIndex == 2) {
        gl_FragColor = vec4(1.0, 0, 0, 1.0);
        return;
      } else if (abs(vNormal.x) < .1 && vNormal.y < -.1 && abs(vNormal.z) < .1 && uIndex == 3) {
        gl_FragColor = vec4(1.0, 0, 0, 1.0);
        return;
      } else if (abs(vNormal.x) < .1 && vNormal.y > .1 && abs(vNormal.z) < .1 && uIndex == 4) {
        gl_FragColor = vec4(1.0, 0, 0, 1.0);
        return;
      } else if (abs(vNormal.x) < .1 && abs(vNormal.y) < .1 && vNormal.z < -.1 && uIndex == 5) {
        gl_FragColor = vec4(1.0, 0, 0, 1.0);
        return;
      } else if (abs(vNormal.x) < .1 && abs(vNormal.y) < .1 && vNormal.z > .1 && uIndex == 6) {
        gl_FragColor = vec4(1.0, 0, 0, 1.0);
        return;
      }

      gl_FragColor = vec4(0, 0, 0, 0);
    }
  </script>
</body>

</html>